; HTML2exe NSIS Installer\r\n; Requires: NSIS 3.x, MUI2\r\n\r\n!include "MUI2.nsh"\r\n!include "FileFunc.nsh"\r\n\r\n!define APP_NAME        "HTML2exe"\r\n!define PUBLISHER       "iD01t Productions"\r\n!define WEBSITE         "https://id01t.store"\r\n!define VERSION         "1.0.0"\r\n!define INSTALL_DIR     "$PROGRAMFILES\\${APP_NAME}"\r\n!define EXE_NAME        "HTML2exe.exe"\r\n!define EXE_PATH        "..\\dist\\${EXE_NAME}"\r\n!define OUTPUT_EXE      "..\\dist\\${APP_NAME}-Setup-${VERSION}.exe"\r\n!define UNINSTALL_KEY   "Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\${APP_NAME}"\r\n\r\nName "${APP_NAME} ${VERSION}"\r\nOutFile "${OUTPUT_EXE}"\r\nInstallDir "${INSTALL_DIR}"\r\nRequestExecutionLevel admin\r\nUnicode true\r\n\r\n; Version Information\r\nVIProductVersion "${VERSION}.0"\r\nVIAddVersionKey "ProductName" "${APP_NAME}"\r\nVIAddVersionKey "CompanyName" "${PUBLISHER}"\r\nVIAddVersionKey "FileDescription" "${APP_NAME} Installer"\r\nVIAddVersionKey "FileVersion" "${VERSION}"\r\nVIAddVersionKey "ProductVersion" "${VERSION}"\r\nVIAddVersionKey "LegalCopyright" "Â© 2024 ${PUBLISHER}"\r\n\r\n; Modern UI Configuration\r\n!define MUI_ABORTWARNING\r\n!define MUI_FINISHPAGE_RUN "$INSTDIR\\${EXE_NAME}"\r\n!define MUI_FINISHPAGE_RUN_TEXT "Launch ${APP_NAME}"\r\n\r\n; Installer Pages\r\n!insertmacro MUI_PAGE_WELCOME\r\n!insertmacro MUI_PAGE_LICENSE "eula.txt"\r\n!insertmacro MUI_PAGE_DIRECTORY\r\n!insertmacro MUI_PAGE_INSTFILES\r\n!insertmacro MUI_PAGE_FINISH\r\n\r\n; Uninstaller Pages\r\n!insertmacro MUI_UNPAGE_CONFIRM\r\n!insertmacro MUI_UNPAGE_INSTFILES\r\n\r\n!insertmacro MUI_LANGUAGE "English"\r\n\r\nSection "Install" SecInstall\r\n  SetOutPath "$INSTDIR"\r\n  File "/oname=${EXE_NAME}" "${EXE_PATH}"\r\n  \r\n  ; Create Start Menu shortcuts\r\n  CreateDirectory "$SMPROGRAMS\\${APP_NAME}"\r\n  CreateShortcut "$SMPROGRAMS\\${APP_NAME}\\${APP_NAME}.lnk" "$INSTDIR\\${EXE_NAME}"\r\n  CreateShortcut "$SMPROGRAMS\\${APP_NAME}\\Uninstall.lnk" "$INSTDIR\\Uninstall.exe"\r\n  \r\n  WriteUninstaller "$INSTDIR\\Uninstall.exe"\r\n  \r\n  ; Registry entries for Add/Remove Programs\r\n  WriteRegStr HKLM "${UNINSTALL_KEY}" "DisplayName" "${APP_NAME}"\r\n  WriteRegStr HKLM "${UNINSTALL_KEY}" "Publisher" "${PUBLISHER}"\r\n  WriteRegStr HKLM "${UNINSTALL_KEY}" "DisplayVersion" "${VERSION}"\r\n  WriteRegStr HKLM "${UNINSTALL_KEY}" "URLInfoAbout" "${WEBSITE}"\r\n  WriteRegStr HKLM "${UNINSTALL_KEY}" "InstallLocation" "$INSTDIR"\r\n  WriteRegStr HKLM "${UNINSTALL_KEY}" "UninstallString" "$INSTDIR\\Uninstall.exe"\r\n  WriteRegDWORD HKLM "${UNINSTALL_KEY}" "NoModify" 1\r\n  WriteRegDWORD HKLM "${UNINSTALL_KEY}" "NoRepair" 1\r\n  \r\n  ${GetSize} "$INSTDIR" "/S=0K" $0 $1 $2\r\n  IntFmt $0 "0x%08X" $0\r\n  WriteRegDWORD HKLM "${UNINSTALL_KEY}" "EstimatedSize" "$0"\r\nSectionEnd\r\n\r\nSection "Uninstall"\r\n  Delete "$INSTDIR\\${EXE_NAME}"\r\n  Delete "$INSTDIR\\Uninstall.exe"\r\n  RMDir /r "$SMPROGRAMS\\${APP_NAME}"\r\n  RMDir "$INSTDIR"\r\n  DeleteRegKey HKLM "${UNINSTALL_KEY}"\r\nSectionEnd
